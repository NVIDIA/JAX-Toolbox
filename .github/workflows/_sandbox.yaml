name: "~Sandbox"

on:
  push:

permissions:
  contents: read  # to fetch code
  actions:  write # to cancel previous workflows
  packages: write # to upload container

jobs:

  test-jax:
    uses: ./.github/workflows/_test_unit.yaml
    with:
      IMAGE: ghcr.io/nvidia/jax:nightly-2024-02-05
      TEST_NAME: jax
      ARTIFACT_NAME: artifact-jax-unit-test
      BADGE_FILENAME: badge-jax-unit-test
    secrets: inherit

  test-pallas:
    uses: ./.github/workflows/_test_unit.yaml
    with:
      IMAGE: ghcr.io/nvidia/jax:nightly-pallas-2024-02-05
      TEST_NAME: pallas
      ARTIFACT_NAME: artifact-pallas-unit-test
      BADGE_FILENAME: badge-pallas-unit-test
    secrets: inherit
