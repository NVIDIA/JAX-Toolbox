name: "~Sandbox"

on:
  workflow_dispatch:
  push:

permissions:
  contents: read  # to fetch code
  actions:  write # to cancel previous workflows
  packages: write # to upload container

jobs:

  build:
    strategy:
      fail-fast: false
      matrix:
        BASE_IMAGE:
          - 'nvidia/cuda:12.2.0-devel-ubuntu22.04'
          - 'nvidia/cuda:12.1.1-devel-ubuntu22.04'
          - 'nvidia/cuda:12.2.0-devel-ubuntu20.04'
          - 'nvidia/cuda:12.1.1-devel-ubuntu20.04'
    uses: ./.github/workflows/_build_base.yaml
    with:
      BUILD_DATE: ${{ needs.metadata.outputs.BUILD_DATE }}
      BASE_IMAGE: ${{ matrix.BASE_IMAGE }}
    secrets: inherit
