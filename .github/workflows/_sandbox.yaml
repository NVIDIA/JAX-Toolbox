name: "~Sandbox"

on:
  push:

jobs:
  test-jax:
    uses: ./.github/workflows/_test_unit.yaml
    with:
      IMAGE: ghcr.io/nvidia/jax:jax
      TEST_NAME: jax
      ARTIFACT_NAME: artifact-jax-unit-test
      BADGE_FILENAME: badge-jax-unit-test
    secrets: inherit

  test-pallas:
    uses: ./.github/workflows/_test_unit.yaml
    with:
      IMAGE: ghcr.io/nvidia/jax:pallas
      TEST_NAME: pallas
      ARTIFACT_NAME: artifact-pallas-unit-test
      BADGE_FILENAME: badge-pallas-unit-test
    secrets: inherit

  test-levanter:
    uses: ./.github/workflows/_test_unit.yaml
    with:
      IMAGE: ghcr.io/nvidia/jax:levanter
      TEST_NAME: levanter
      ARTIFACT_NAME: artifact-levanter-unit-test
      BADGE_FILENAME: badge-levanter-unit-test
    secrets: inherit
