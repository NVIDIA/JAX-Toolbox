name: "~Sandbox"

on:
  workflow_dispatch:
  push:

permissions:
  contents: read  # to fetch code
  actions:  write # to cancel previous workflows
  packages: write # to upload container

jobs:

  build:
    uses: ./.github/workflows/_build_jax.yaml
    with:
      BUILD_DATE: '2023-09-12'
    secrets: inherit

  run:
    needs: build
    uses: ./.github/workflows/_test_jax.yaml
    with:
      JAX_IMAGE: ${{ needs.build.outputs.DOCKER_TAGS }}
    secrets: inherit
