#!/bin/bash

## Helper functions for CI scripts. Source this file.

_CURRENT_SCRIPT=$0
in_ci() {
  [[ "${CI:-}" == "true" ]] && return 0 || return 1
}
export -f in_ci

decho() {
  if in_ci; then
    echo "::debug::"$@
  else
    echo "[DEBUG]:" $@
  fi
}
export -f decho

wecho() {
  if in_ci; then
    echo "::warning file=$_CURRENT_SCRIPT,line=${BASH_LINENO[0]}::"$@
  else
    echo "[WARNING]:" $@
  fi
}
export -f wecho

eecho() {
  if in_ci; then
    echo "::error file=$_CURRENT_SCRIPT,line=${BASH_LINENO[0]}::"$@
  else
    echo "[ERROR]:" $@
  fi
}
export -f eecho
