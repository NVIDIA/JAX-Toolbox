name: Delete GHCR Token
description: Deletes the K8s secret used for pulling images from GHCR.

inputs:
  token-name:
    description: Name of the K8s secret to delete
    required: true

runs:
  using: "composite"
  steps:
    - name: Delete GitHub Container Registry token
      uses: ./.github/actions/with-post-step
      with: 
        main: | 
          # Store GitHub Container Registry token as Kubernetes secret
          kubectl create secret generic \
          ${{ inputs.token-name }} \
          --from-file=.dockerconfigjson=$HOME/.docker/config.json \
          --type=kubernetes.io/dockerconfigjson
        post: |
          kubectl delete secret ${{ inputs.token-name }}